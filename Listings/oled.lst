C51 COMPILER V9.60.0.0   OLED                                                              04/13/2021 19:30:18 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE OLED
OBJECT MODULE PLACED IN .\Objects\oled.obj
COMPILER INVOKED BY: E:\KEIL5\C51\BIN\C51.EXE Core\Src\oled.c LARGE OPTIMIZE(8,SPEED) BROWSE INCDIR(.\Core\Inc) DEBUG OB
                    -JECTEXTEND PRINT(.\Listings\oled.lst) TABS(2) OBJECT(.\Objects\oled.obj)

line level    source

   1          /**
   2           ******************************************************************************
   3           * @file    oled.c
   4           * @author  sky-vocality
   5           * @version V1.0.0
   6           * @date    9-April-2021
   7           * @brief  This file is a oled driver
   8           * @License:GNU General Public License v3.0         
   9           ******************************************************************************
  10           * @attention
  11           * 
  12           * 
  13           * 
  14           * 
  15           * 
  16           * 
  17           * 
  18           * 
  19           ******************************************************************************
  20          **/
  21          
  22          #include "oled.h"
  23          
  24          //asciiÂ≠óÁ¨¶ÈõÜ
  25          const unsigned char F6x8[][6] =
  26          {
  27              { 0x00, 0x00, 0x00, 0x00, 0x00, 0x00 },   // sp
  28              { 0x00, 0x00, 0x00, 0x2f, 0x00, 0x00 },   // !
  29              { 0x00, 0x00, 0x07, 0x00, 0x07, 0x00 },   // "
  30              { 0x00, 0x14, 0x7f, 0x14, 0x7f, 0x14 },   // #
  31              { 0x00, 0x24, 0x2a, 0x7f, 0x2a, 0x12 },   // $
  32              { 0x00, 0x62, 0x64, 0x08, 0x13, 0x23 },   // %
  33              { 0x00, 0x36, 0x49, 0x55, 0x22, 0x50 },   // &
  34              { 0x00, 0x00, 0x05, 0x03, 0x00, 0x00 },   // '
  35              { 0x00, 0x00, 0x1c, 0x22, 0x41, 0x00 },   // (
  36              { 0x00, 0x00, 0x41, 0x22, 0x1c, 0x00 },   // )
  37              { 0x00, 0x14, 0x08, 0x3E, 0x08, 0x14 },   // *
  38              { 0x00, 0x08, 0x08, 0x3E, 0x08, 0x08 },   // +
  39              { 0x00, 0x00, 0x00, 0xA0, 0x60, 0x00 },   // ,
  40              { 0x00, 0x08, 0x08, 0x08, 0x08, 0x08 },   // -
  41              { 0x00, 0x00, 0x60, 0x60, 0x00, 0x00 },   // .
  42              { 0x00, 0x20, 0x10, 0x08, 0x04, 0x02 },   // /
  43              { 0x00, 0x3E, 0x51, 0x49, 0x45, 0x3E },   // 0
  44              { 0x00, 0x00, 0x42, 0x7F, 0x40, 0x00 },   // 1
  45              { 0x00, 0x42, 0x61, 0x51, 0x49, 0x46 },   // 2
  46              { 0x00, 0x21, 0x41, 0x45, 0x4B, 0x31 },   // 3
  47              { 0x00, 0x18, 0x14, 0x12, 0x7F, 0x10 },   // 4
  48              { 0x00, 0x27, 0x45, 0x45, 0x45, 0x39 },   // 5
  49              { 0x00, 0x3C, 0x4A, 0x49, 0x49, 0x30 },   // 6
  50              { 0x00, 0x01, 0x71, 0x09, 0x05, 0x03 },   // 7
  51              { 0x00, 0x36, 0x49, 0x49, 0x49, 0x36 },   // 8
  52              { 0x00, 0x06, 0x49, 0x49, 0x29, 0x1E },   // 9
  53              { 0x00, 0x00, 0x36, 0x36, 0x00, 0x00 },   // :
  54              { 0x00, 0x00, 0x56, 0x36, 0x00, 0x00 },   // ;
C51 COMPILER V9.60.0.0   OLED                                                              04/13/2021 19:30:18 PAGE 2   

  55              { 0x00, 0x08, 0x14, 0x22, 0x41, 0x00 },   // <
  56              { 0x00, 0x14, 0x14, 0x14, 0x14, 0x14 },   // =
  57              { 0x00, 0x00, 0x41, 0x22, 0x14, 0x08 },   // >
  58              { 0x00, 0x02, 0x01, 0x51, 0x09, 0x06 },   // ?
  59              { 0x00, 0x32, 0x49, 0x59, 0x51, 0x3E },   // @
  60              { 0x00, 0x7C, 0x12, 0x11, 0x12, 0x7C },   // A
  61              { 0x00, 0x7F, 0x49, 0x49, 0x49, 0x36 },   // B
  62              { 0x00, 0x3E, 0x41, 0x41, 0x41, 0x22 },   // C
  63              { 0x00, 0x7F, 0x41, 0x41, 0x22, 0x1C },   // D
  64              { 0x00, 0x7F, 0x49, 0x49, 0x49, 0x41 },   // E
  65              { 0x00, 0x7F, 0x09, 0x09, 0x09, 0x01 },   // F
  66              { 0x00, 0x3E, 0x41, 0x49, 0x49, 0x7A },   // G
  67              { 0x00, 0x7F, 0x08, 0x08, 0x08, 0x7F },   // H
  68              { 0x00, 0x00, 0x41, 0x7F, 0x41, 0x00 },   // I
  69              { 0x00, 0x20, 0x40, 0x41, 0x3F, 0x01 },   // J
  70              { 0x00, 0x7F, 0x08, 0x14, 0x22, 0x41 },   // K
  71              { 0x00, 0x7F, 0x40, 0x40, 0x40, 0x40 },   // L
  72              { 0x00, 0x7F, 0x02, 0x0C, 0x02, 0x7F },   // M
  73              { 0x00, 0x7F, 0x04, 0x08, 0x10, 0x7F },   // N
  74              { 0x00, 0x3E, 0x41, 0x41, 0x41, 0x3E },   // O
  75              { 0x00, 0x7F, 0x09, 0x09, 0x09, 0x06 },   // P
  76              { 0x00, 0x3E, 0x41, 0x51, 0x21, 0x5E },   // Q
  77              { 0x00, 0x7F, 0x09, 0x19, 0x29, 0x46 },   // R
  78              { 0x00, 0x46, 0x49, 0x49, 0x49, 0x31 },   // S
  79              { 0x00, 0x01, 0x01, 0x7F, 0x01, 0x01 },   // T
  80              { 0x00, 0x3F, 0x40, 0x40, 0x40, 0x3F },   // U
  81              { 0x00, 0x1F, 0x20, 0x40, 0x20, 0x1F },   // V
  82              { 0x00, 0x3F, 0x40, 0x38, 0x40, 0x3F },   // W
  83              { 0x00, 0x63, 0x14, 0x08, 0x14, 0x63 },   // X
  84              { 0x00, 0x07, 0x08, 0x70, 0x08, 0x07 },   // Y
  85              { 0x00, 0x61, 0x51, 0x49, 0x45, 0x43 },   // Z
  86              { 0x00, 0x00, 0x7F, 0x41, 0x41, 0x00 },   // [
  87              { 0x00, 0x55, 0x2A, 0x55, 0x2A, 0x55 },   // 55
  88              { 0x00, 0x00, 0x41, 0x41, 0x7F, 0x00 },   // ]
  89              { 0x00, 0x04, 0x02, 0x01, 0x02, 0x04 },   // ^
  90              { 0x00, 0x40, 0x40, 0x40, 0x40, 0x40 },   // _
  91              { 0x00, 0x00, 0x01, 0x02, 0x04, 0x00 },   // '
  92              { 0x00, 0x20, 0x54, 0x54, 0x54, 0x78 },   // a
  93              { 0x00, 0x7F, 0x48, 0x44, 0x44, 0x38 },   // b
  94              { 0x00, 0x38, 0x44, 0x44, 0x44, 0x20 },   // c
  95              { 0x00, 0x38, 0x44, 0x44, 0x48, 0x7F },   // d
  96              { 0x00, 0x38, 0x54, 0x54, 0x54, 0x18 },   // e
  97              { 0x00, 0x08, 0x7E, 0x09, 0x01, 0x02 },   // f
  98              { 0x00, 0x18, 0xA4, 0xA4, 0xA4, 0x7C },   // g
  99              { 0x00, 0x7F, 0x08, 0x04, 0x04, 0x78 },   // h
 100              { 0x00, 0x00, 0x44, 0x7D, 0x40, 0x00 },   // i
 101              { 0x00, 0x40, 0x80, 0x84, 0x7D, 0x00 },   // j
 102              { 0x00, 0x7F, 0x10, 0x28, 0x44, 0x00 },   // k
 103              { 0x00, 0x00, 0x41, 0x7F, 0x40, 0x00 },   // l
 104              { 0x00, 0x7C, 0x04, 0x18, 0x04, 0x78 },   // m
 105              { 0x00, 0x7C, 0x08, 0x04, 0x04, 0x78 },   // n
 106              { 0x00, 0x38, 0x44, 0x44, 0x44, 0x38 },   // o
 107              { 0x00, 0xFC, 0x24, 0x24, 0x24, 0x18 },   // p
 108              { 0x00, 0x18, 0x24, 0x24, 0x18, 0xFC },   // q
 109              { 0x00, 0x7C, 0x08, 0x04, 0x04, 0x08 },   // r
 110              { 0x00, 0x48, 0x54, 0x54, 0x54, 0x20 },   // s
 111              { 0x00, 0x04, 0x3F, 0x44, 0x40, 0x20 },   // t
 112              { 0x00, 0x3C, 0x40, 0x40, 0x20, 0x7C },   // u
 113              { 0x00, 0x1C, 0x20, 0x40, 0x20, 0x1C },   // v
 114              { 0x00, 0x3C, 0x40, 0x30, 0x40, 0x3C },   // w
 115              { 0x00, 0x44, 0x28, 0x10, 0x28, 0x44 },   // x
 116              { 0x00, 0x1C, 0xA0, 0xA0, 0xA0, 0x7C },   // y
C51 COMPILER V9.60.0.0   OLED                                                              04/13/2021 19:30:18 PAGE 3   

 117              { 0x00, 0x44, 0x64, 0x54, 0x4C, 0x44 },   // z
 118              { 0x14, 0x14, 0x14, 0x14, 0x14, 0x14 }    // horiz lines
 119          };
 120          
 121          void Delay_1ms(unsigned int Del_1ms)
 122          { 
 123   1          Delay_Us(Del_1ms);
 124   1      }
 125          
 126          void IIC_Start()
 127          {
 128   1          LCD_SCL = HIGH;
 129   1          Delay_1ms(2);
 130   1          LCD_SDA = HIGH;
 131   1          Delay_1ms(2);
 132   1          LCD_SDA = LOW;
 133   1          Delay_1ms(2);
 134   1          LCD_SCL = LOW;
 135   1          Delay_1ms(2);
 136   1      }
 137          
 138          void IIC_Stop()
 139          {
 140   1          LCD_SCL = LOW;
 141   1          Delay_1ms(2);
 142   1          LCD_SDA = LOW;
 143   1          Delay_1ms(2);
 144   1          LCD_SCL = HIGH;
 145   1          Delay_1ms(2);
 146   1          LCD_SDA = HIGH;
 147   1          Delay_1ms(2);
 148   1      }
 149          
 150          void Write_IIC_Byte(unsigned char IIC_Byte)
 151          {
 152   1          unsigned char i;
 153   1          for(i=0;i<8;i++)    
 154   1          {
 155   2              if(IIC_Byte & 0x80)
 156   2              {       
 157   3              LCD_SDA=HIGH;
 158   3              }
 159   2              else 
 160   2              {      
 161   3              LCD_SDA=LOW;
 162   3              }
 163   2              Delay_1ms(1);
 164   2              LCD_SCL=HIGH;
 165   2              Delay_1ms(1);
 166   2              LCD_SCL=LOW;
 167   2              Delay_1ms(1);
 168   2              IIC_Byte<<=1;   //loop
 169   2          }
 170   1          LCD_SDA=1;
 171   1          Delay_1ms(1);
 172   1          LCD_SCL=1;
 173   1          Delay_1ms(1);
 174   1          LCD_SCL=0;
 175   1          Delay_1ms(1);
 176   1      }
 177          
 178          void LCD_WrDat(unsigned char dat)
C51 COMPILER V9.60.0.0   OLED                                                              04/13/2021 19:30:18 PAGE 4   

 179          {
 180   1          IIC_Start();
 181   1          Write_IIC_Byte(IICADRR);      
 182   1          Write_IIC_Byte(0x40);     //write data
 183   1          Write_IIC_Byte(dat);
 184   1          IIC_Stop();
 185   1      }
 186          
 187          void LCD_WrCmd(unsigned char cmd)
 188          {
 189   1          IIC_Start();
 190   1          Write_IIC_Byte(IICADRR);              //Slave Address,SA0=0
 191   1          Write_IIC_Byte(0x00);     //write command
 192   1          Write_IIC_Byte(cmd); 
 193   1          IIC_Stop();
 194   1      }
 195          
 196          //========================================================================
 197          // Function:void LCD_Set_Pos(unsigned char x, unsigned char y)|ÂáΩÊï∞:  void LCD_Set_Pos(unsigned char x, 
             -unsigned char y)
 198          // Description:Set the coordinates of the pixels|ÊèèËø∞:ËÆæÁΩÆÂÉèÁ¥†ÁÇπÁöÑÂùêÊ†á
 199          // Parameter: x,y:The coordinate value (x, y) of the pointÔºå the range of x is 0-127, and the range of y 
             -is 0-64|ÂèÇÊï∞:ÁÇπÁöÑÂùêÊ†áÂÄº(x,y),xÁöÑËåÉÂõ¥0ÔΩû127ÔºåyÁöÑËåÉÂõ¥0ÔΩû64
 200          // 
 201          //       
 202          // Return:|ËøîÂõû: 
 203          // Version:VER1.0.0|ÁâàÊú¨: VER1.0.0
 204          // Date:2021-04-09|Êó•Êúü: 2021-04-09
 205          // Author: sky-vocality|‰ΩúËÄÖ: sky-vocality
 206          // Note:|Â§áÊ≥®:
 207          //  
 208          //  
 209          //  
 210          //  
 211          //  
 212          //========================================================================
 213          void LCD_Set_Pos(unsigned char x, unsigned char y)
 214          {
 215   1          LCD_WrCmd(0xb0+y);
 216   1          LCD_WrCmd(((x&0xf0)>>4)|0x10);
 217   1          LCD_WrCmd((x&0x0f)); 
 218   1      } 
 219          
 220          //========================================================================
 221          // Function:void LCD_Fill(unsigned char bmp_data)|ÂáΩÊï∞:void LCD_Fill(unsigned char bmp_data)
 222          // Description:Initial screen clearing|ÊèèËø∞:ÂàùÂßãÊ∏ÖÂ±è
 223          // Parameter: bmp_data:Populated data|ÂèÇÊï∞:Â°´ÂÖÖÁöÑÊï∞ÊçÆ
 224          // 
 225          //       
 226          // Return:|ËøîÂõû: 
 227          // Version:VER1.0.0|ÁâàÊú¨: VER1.0.0
 228          // Date:2021-04-09|Êó•Êúü: 2021-04-09
 229          // Author: sky-vocality|‰ΩúËÄÖ: sky-vocality
 230          // Note:|Â§áÊ≥®:
 231          //  
 232          //  
 233          //  
 234          //  
 235          //  
 236          //========================================================================
 237          void LCD_Fill(unsigned char bmp_data)
 238          {
C51 COMPILER V9.60.0.0   OLED                                                              04/13/2021 19:30:18 PAGE 5   

 239   1          unsigned char y,x;
 240   1      
 241   1          for(y=0;y<8;y++)
 242   1          {
 243   2              LCD_WrCmd(0xb0+y);
 244   2              LCD_WrCmd(0x01);
 245   2              LCD_WrCmd(0x10);
 246   2              for(x=0;x<X_WIDTH;x++)
 247   2                  LCD_WrDat(bmp_data);
 248   2          }
 249   1      }
 250          
 251          //========================================================================
 252          // Function:void LCD_CLS(void)|ÂáΩÊï∞:void LCD_CLS(void)
 253          // Description:Screen clearing|ÊèèËø∞:Ê∏ÖÂ±è
 254          // Parameter:|ÂèÇÊï∞:
 255          // 
 256          //       
 257          // Return:|ËøîÂõû: 
 258          // Version:VER1.0.0|ÁâàÊú¨: VER1.0.0
 259          // Date:2021-04-09|Êó•Êúü: 2021-04-09
 260          // Author: sky-vocality|‰ΩúËÄÖ: sky-vocality
 261          // Note:|Â§áÊ≥®:
 262          //  
 263          //  
 264          //  
 265          //  
 266          //  
 267          //========================================================================
 268          void LCD_CLS(void)
 269          {
 270   1          unsigned char y,x;  
 271   1          for(y=0;y<8;y++)
 272   1          {
 273   2              LCD_WrCmd(0xb0+y);
 274   2              LCD_WrCmd(0x01);
 275   2              LCD_WrCmd(0x10); 
 276   2              for(x=0;x<X_WIDTH;x++)
 277   2              LCD_WrDat(0);
 278   2          }
 279   1      }
 280          
 281          void LCD_Init(void)        
 282          { 
 283   1          //-----Á´ØÂè£ÂàùÂßãÂåñ----//
 284   1          GPIO_InitTypeDef GPIO_InitTypeDef;
 285   1          GPIO_InitTypeDef.Mode = GPIO_PullUp;//‰∏äÊãâÂáÜÂèåÂêëÂè£
 286   1          GPIO_InitTypeDef.Pin = GPIO_Pin_3;
 287   1          GPIO_Inilize(GPIO_P2 ,&GPIO_InitTypeDef);
 288   1          GPIO_Inilize(GPIO_P3 ,&GPIO_InitTypeDef);
 289   1          GPIO_Inilize(GPIO_P4 ,&GPIO_InitTypeDef);
 290   1      
 291   1          LCD_SCL=1;              
 292   1          LCD_RST=0;
 293   1          Delay_Ms(500);
 294   1          LCD_RST=1;
 295   1      
 296   1          LCD_WrCmd(0xae);//--turn off oled panel
 297   1          LCD_WrCmd(0x00);//---set low column address
 298   1          LCD_WrCmd(0x10);//---set high column address
 299   1          LCD_WrCmd(0x40);//--set start line address  Set Mapping RAM Display Start Line (0x00~0x3F)
 300   1          LCD_WrCmd(0x81);//--set contrast control register
C51 COMPILER V9.60.0.0   OLED                                                              04/13/2021 19:30:18 PAGE 6   

 301   1          LCD_WrCmd(0xcf); // Set SEG Output Current Brightness
 302   1          LCD_WrCmd(0xa1);//--Set SEG/Column Mapping     0xa0Â∑¶Âè≥ÂèçÁΩÆ 0xa1Ê≠£Â∏∏
 303   1          LCD_WrCmd(0xc8);//Set COM/Row Scan Direction   0xc0‰∏ä‰∏ãÂèçÁΩÆ 0xc8Ê≠£Â∏∏
 304   1          LCD_WrCmd(0xa6);//--set normal display
 305   1          LCD_WrCmd(0xa8);//--set multiplex ratio(1 to 64)
 306   1          LCD_WrCmd(0x3f);//--1/64 duty
 307   1          LCD_WrCmd(0xd3);//-set display offset Shift Mapping RAM Counter (0x00~0x3F)
 308   1          LCD_WrCmd(0x00);//-not offset
 309   1          LCD_WrCmd(0xd5);//--set display clock divide ratio/oscillator frequency
 310   1          LCD_WrCmd(0x80);//--set divide ratio, Set Clock as 100 Frames/Sec
 311   1          LCD_WrCmd(0xd9);//--set pre-charge period
 312   1          LCD_WrCmd(0xf1);//Set Pre-Charge as 15 Clocks & Discharge as 1 Clock
 313   1          LCD_WrCmd(0xda);//--set com pins hardware configuration
 314   1          LCD_WrCmd(0x12);
 315   1          LCD_WrCmd(0xdb);//--set vcomh
 316   1          LCD_WrCmd(0x40);//Set VCOM Deselect Level
 317   1          LCD_WrCmd(0x20);//-Set Page Addressing Mode (0x00/0x01/0x02)
 318   1          LCD_WrCmd(0x02);//
 319   1          LCD_WrCmd(0x8d);//--set Charge Pump enable/disable
 320   1          LCD_WrCmd(0x14);//--set(0x10) disable
 321   1          LCD_WrCmd(0xa4);// Disable Entire Display On (0xa4/0xa5)
 322   1          LCD_WrCmd(0xa6);// Disable Inverse Display On (0xa6/a7) 
 323   1          LCD_WrCmd(0xaf);//--turn on oled panel
 324   1          LCD_Fill(0x00);  //ÂàùÂßãÊ∏ÖÂ±è
 325   1          LCD_Set_Pos(0,0);    
 326   1      }
 327          
 328          //========================================================================
 329          // Function:void LCD_PutPixel(unsigned char x,unsigned char y)|ÂáΩÊï∞:void LCD_PutPixel(unsigned char x,un
             -signed char y)
 330          // Description:Draw a point|Áîª‰∏Ä‰∏™ÁÇπ
 331          // Parameter: x,y:The coordinate value of the point (x, y), the range of X is 0-127, and the range of Y is
             - 0-64|ÂèÇÊï∞:ÁÇπÁöÑÂùêÊ†áÂÄº(x,y),xÁöÑËåÉÂõ¥0ÔΩû127ÔºåyÁöÑËåÉÂõ¥0ÔΩû64
 332          // 
 333          //       
 334          // Return:|ËøîÂõû: 
 335          // Version:VER1.0.0|ÁâàÊú¨: VER1.0.0
 336          // Date:2021-04-09|Êó•Êúü: 2021-04-09
 337          // Author: sky-vocality|‰ΩúËÄÖ: sky-vocality
 338          // Note:|Â§áÊ≥®:
 339          //  
 340          //  
 341          //  
 342          //  
 343          //  
 344          //========================================================================
 345          void LCD_PutPixel(unsigned char x,unsigned char y)
 346          {
 347   1          unsigned char data1;
 348   1      
 349   1          LCD_Set_Pos(x,(unsigned char)(y>>3)); 
 350   1          data1 =(unsigned char)(0x01<<(y%8));
 351   1          LCD_WrCmd((unsigned char)(0xb0+(y>>3)));
 352   1          LCD_WrCmd((unsigned char)(((x&0xf0)>>4)|0x10));
 353   1          LCD_WrCmd((unsigned char)((x&0x0f)|0x00));
 354   1          LCD_WrDat(data1);
 355   1      }
 356          
 357          //========================================================================
 358          // Function:void LCD_P6x8Str(unsigned char x,unsigned char y,unsigned char ch[])|ÂáΩÊï∞:void LCD_P6x8Str(u
             -nsigned char x,unsigned char y,unsigned char ch[])
 359          // Description:Writes a set of ascii strings|ÂÜôÂÖ•‰∏ÄÁªÑÊ†áÂáÜASCIIÂ≠óÁ¨¶‰∏≤
C51 COMPILER V9.60.0.0   OLED                                                              04/13/2021 19:30:18 PAGE 7   

 360          // Parameter: x,y:Display location, y is the page range 0-7|ÂèÇÊï∞:ÊòæÁ§∫ÁöÑ‰ΩçÁΩÆÔºàx,yÔºâÔºåy‰∏∫È°µËåÉÂõ
             -¥0ÔΩû7
 361          //            *p:String to display|Ë¶ÅÊòæÁ§∫ÁöÑÂ≠óÁ¨¶‰∏≤
 362          //
 363          //       
 364          // Return:|ËøîÂõû: 
 365          // Version:VER1.0.0|ÁâàÊú¨: VER1.0.0
 366          // Date:2021-04-09|Êó•Êúü: 2021-04-09
 367          // Author: sky-vocality|‰ΩúËÄÖ: sky-vocality
 368          // Note:|Â§áÊ≥®:
 369          //  
 370          //  
 371          //  
 372          //  
 373          //  
 374          //======================================================================== 
 375          void LCD_P6x8Str(unsigned char x,unsigned char y,unsigned char ch[])
 376          {
 377   1          unsigned char c=0,i=0,j=0;      
 378   1          while (ch[j]!='\0')
 379   1          {    
 380   2              c =ch[j]-32;
 381   2              if(x>126){x=0;y++;}
 382   2              LCD_Set_Pos(x,y);    
 383   2              for(i=0;i<6;i++)     
 384   2                  LCD_WrDat(F6x8[c][i]);  
 385   2              x+=6;
 386   2              j++;
 387   2          }
 388   1      }
 389          
 390          //========================================================================
 391          // Function:void LCD_PrintU16(unsigned char x,unsigned char y,unsigned int num)|ÂáΩÊï∞:void LCD_PrintU16(u
             -nsigned char x,unsigned char y,unsigned int num)
 392          // Description:display uint|ÊòæÁ§∫Êó†Á¨¶Âè∑Êï¥Âûã
 393          // Parameter: x,y:Display location, y is the page range 0-7|ÂèÇÊï∞:ÊòæÁ§∫ÁöÑ‰ΩçÁΩÆÔºàx,yÔºâÔºåy‰∏∫È°µËåÉÂõ
             -¥0ÔΩû7
 394          //            num:uint to display|Ë¶ÅÊòæÁ§∫ÁöÑÊó†Á¨¶Âè∑Êï¥Âûã
 395          //
 396          //       
 397          // Return:|ËøîÂõû: 
 398          // Version:VER1.0.0|ÁâàÊú¨: VER1.0.0
 399          // Date:2021-04-09|Êó•Êúü: 2021-04-09
 400          // Author: sky-vocality|‰ΩúËÄÖ: sky-vocality
 401          // Note:|Â§áÊ≥®:
 402          //  
 403          //  
 404          //  
 405          //  
 406          //  
 407          //========================================================================
 408          void LCD_PrintU16(unsigned char x,unsigned char y,unsigned int num)
 409          {
 410   1          unsigned char tmp[6],i;
 411   1          tmp[5]=0;
 412   1          tmp[4]=(unsigned char)(num%10+0x30);
 413   1          tmp[3]=(unsigned char)(num/10%10+0x30);
 414   1          tmp[2]=(unsigned char)(num/100%10+0x30);
 415   1          tmp[1]=(unsigned char)(num/1000%10+0x30);
 416   1          tmp[0]=(unsigned char)(num/10000%10+0x30);
 417   1      
 418   1          for(i=0;i<4;i++)
C51 COMPILER V9.60.0.0   OLED                                                              04/13/2021 19:30:18 PAGE 8   

 419   1          {
 420   2              if(tmp[i]=='0')
 421   2                  tmp[i]=' ';
 422   2              else
 423   2                  break;
 424   2          }
 425   1      
 426   1          LCD_P6x8Str(x,y,tmp);
 427   1      
 428   1      }
 429          
 430          //========================================================================
 431          // Function:void LCD_Print16(unsigned char x,unsigned char y,int num)|ÂáΩÊï∞:void LCD_Print16(unsigned cha
             -r x,unsigned char y,int num)
 432          // Description:display uint|ÊòæÁ§∫Êï¥Âûã
 433          // Parameter: x,y:Display location, y is the page range 0-7|ÂèÇÊï∞:ÊòæÁ§∫ÁöÑ‰ΩçÁΩÆÔºàx,yÔºâÔºåy‰∏∫È°µËåÉÂõ
             -¥0ÔΩû7
 434          //            num:uint to display|Ë¶ÅÊòæÁ§∫ÁöÑÊï¥Âûã
 435          //
 436          //       
 437          // Return:|ËøîÂõû: 
 438          // Version:VER1.0.0|ÁâàÊú¨: VER1.0.0
 439          // Date:2021-04-11|Êó•Êúü: 2021-04-11
 440          // Author: sky-vocality|‰ΩúËÄÖ: sky-vocality
 441          // Note:|Â§áÊ≥®:
 442          //  
 443          //  
 444          //  
 445          //  
 446          //  
 447          //========================================================================
 448          void LCD_Print16(unsigned char x,unsigned char y,int num)
 449          {
 450   1        int i,j,flag;
 451   1          unsigned char stack[10];
 452   1        unsigned char tmp[10];
 453   1          i=0;
 454   1          if (num<0){
 455   2              flag=0;
 456   2              num=-num;
 457   2          }else{
 458   2              flag=1;
 459   2          }
 460   1          while (num/10!=0){
 461   2              stack[i]=(char)(48+num%10);
 462   2              num=num/10;
 463   2              i++;
 464   2          }
 465   1          stack[i]=(char)(48+num);
 466   1          if (flag==0){
 467   2              tmp[0]='-';
 468   2              for (j=i;j>-1;j--){
 469   3                  tmp[i-j+1]=stack[j];
 470   3              }
 471   2              tmp[i+2]='\0';
 472   2          }else{
 473   2              for (j=i;j>-1;j--){
 474   3                  tmp[i-j]=stack[j];
 475   3              }
 476   2              tmp[i+1]='\0';
 477   2          }
 478   1      
C51 COMPILER V9.60.0.0   OLED                                                              04/13/2021 19:30:18 PAGE 9   

 479   1          LCD_P6x8Str(x,y,tmp);
 480   1      
 481   1      }
 482          
 483          //========================================================================
 484          // Function:void LCD_PrintFloat(unsigned char x,unsigned char y,float num)|ÂáΩÊï∞:void LCD_PrintFloat(unsi
             -gned char x,unsigned char y,float num)
 485          // Description:display uint|ÊòæÁ§∫ÊµÆÁÇπÊï∞
 486          // Parameter: x,y:Display location, y is the page range 0-7|ÂèÇÊï∞:ÊòæÁ§∫ÁöÑ‰ΩçÁΩÆÔºàx,yÔºâÔºåy‰∏∫È°µËåÉÂõ
             -¥0ÔΩû7
 487          //            num:uint to display|Ë¶ÅÊòæÁ§∫ÁöÑÊµÆÁÇπÊï∞
 488          //
 489          //       
 490          // Return:|ËøîÂõû: 
 491          // Version:VER1.0.1|ÁâàÊú¨: VER1.0.1
 492          // Date:2021-04-11|Êó•Êúü: 2021-04-11
 493          // Author: sky-vocality|‰ΩúËÄÖ: sky-vocality
 494          // Note:|Â§áÊ≥®:
 495          //  
 496          //  
 497          //  
 498          //  
 499          //  
 500          //========================================================================
 501          void LCD_PrintFloat(unsigned char x,unsigned char y,float num)
 502          {
 503   1        int temp,i,j;
 504   1        int n = 10;
 505   1        char tmp[10];
 506   1          if(num>=0)//Âà§Êñ≠ÊòØÂê¶Â§ß‰∫é0
 507   1              tmp[0] = '+';
 508   1          else
 509   1          {
 510   2              tmp[0] = '-';
 511   2              num = -num;
 512   2          }
 513   1          temp = (int)num;//ÂèñÊï¥Êï∞ÈÉ®ÂàÜ
 514   1          for(i=0;temp!=0;i++)//ËÆ°ÁÆóÊï¥Êï∞ÈÉ®ÂàÜÁöÑ‰ΩçÊï∞
 515   1              temp /=10;
 516   1          temp =(int)num;
 517   1          for(j=i;j>0;j--)//Â∞ÜÊï¥Êï∞ÈÉ®ÂàÜËΩ¨Êç¢ÊàêÂ≠óÁ¨¶‰∏≤Âûã
 518   1          {
 519   2              tmp[j] = temp%10+'0';
 520   2              temp /=10;
 521   2          }
 522   1          tmp[i+1] = '.';
 523   1          num -=(int)num;
 524   1          for(i=i+2;i<n-1;i++)//Â∞ÜÂ∞èÊï∞ÈÉ®ÂàÜËΩ¨Êç¢ÊàêÂ≠óÁ¨¶‰∏≤Âûã
 525   1          {
 526   2              num*=10;
 527   2              tmp[i]=(int)num+'0';
 528   2              num-=(int)num;
 529   2          }
 530   1          tmp[n-1] = '\0';
 531   1        
 532   1          LCD_P6x8Str(x,y,tmp);
 533   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =   1999    ----
   CONSTANT SIZE    =   ----    ----
C51 COMPILER V9.60.0.0   OLED                                                              04/13/2021 19:30:18 PAGE 10  

   XDATA SIZE       =    552      81
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
