C51 COMPILER V9.59.0.0   PWM                                                               02/01/2021 21:09:41 PAGE 1   


C51 COMPILER V9.59.0.0, COMPILATION OF MODULE PWM
OBJECT MODULE PLACED IN .\Objects\pwm.obj
COMPILER INVOKED BY: C:\Keil_v5\C51\BIN\C51.EXE Core\Src\pwm.c OPTIMIZE(8,SPEED) BROWSE INCDIR(.\Core\Inc) DEBUG OBJECTE
                    -XTEND PRINT(.\Listings\pwm.lst) TABS(2) OBJECT(.\Objects\pwm.obj)

line level    source

   1          /**
   2            ******************************************************************************
   3            * @file    PWM.H
   4            * @author  PineconePi (BTA-16 And xdd_core)
   5            * @version V1.0.0
   6            * @date    20-February-2019
   7            * @brief  This document is used for PWM configuration
   8            * @License:GNU General Public License v3.0         
   9            ******************************************************************************
  10            * @attention
  11            *
  12            *  
  13            * 
  14            * 
  15            * 
  16            * 
  17            *
  18            * 
  19            ******************************************************************************
  20            **/
  21          #include "pwm.h"
  22          
  23          //========================================================================
  24          // Function:void PWM_Output(unsigned char PWM_Number,PWM_InitTypeDef *PWMx)|函数: void PWM_Output(unsigned
             - char PWM_Number,PWM_InitTypeDef *PWMx)
  25          // Description:PWM module output function.|描述: PWM模块输出函数。
  26          // Parameters: PWM_Number (PWM module number parameter range: 0-7)
  27          //             * PWMx: See PWM.h for details
  28          // 参数: PWM_Number   (PWM模块编号 参数范围：0~7)
  29          //     *PWMx：详情见PWM.h
  30          // Return: None.|返回: None.
  31          // Version:VER1.0.0|版本: VER1.0.0
  32          // Date:2018-12-20|日期: 2019-2-10
  33          // Note:|备注: 
  34          // 
  35          //========================================================================
  36          void PWM_Output(unsigned char PWM_Number,PWM_InitTypeDef *PWMx)
  37          { 
  38   1        float PWM_Buf = 0,PWM_Pre = 0,PWM_Value;
  39   1        PWM_Buf = ( 1500000 / PWMx->PWM_Frequency );
  40   1        PWM_Value = 1000 - PWMx->PWM_Value;
  41   1        PWM_Pre = (PWM_Value/1000);
  42   1        P_SW2 = 0x80;                               //Allow access to extended RAM (STC added)|允许访问扩展RAM（STC新增）
  43   1        PWMCKS = 0x0f;                                 //System Clock 16 Dividing Frequency|系统时钟16分频
  44   1        PWMC = PWM_Buf; 
  45   1        switch(PWM_Number)
  46   1        {
  47   2          case 0 : PWM0T1 = 0x0000;PWM0T2 = PWM_Buf*PWM_Pre;PWM0CR= 0x80|PWMx->PWM_Channelx;break;
  48   2          case 1 : PWM1T1 = 0x0000;PWM1T2 = PWM_Buf*PWM_Pre;PWM1CR= 0x80|PWMx->PWM_Channelx;break;
  49   2          case 2 : PWM2T1 = 0x0000;PWM2T2 = PWM_Buf*PWM_Pre;PWM2CR= 0x80|PWMx->PWM_Channelx;break;
  50   2          case 3 : PWM3T1 = 0x0000;PWM3T2 = PWM_Buf*PWM_Pre;PWM3CR= 0x80|PWMx->PWM_Channelx;break;
  51   2          case 4 : PWM4T1 = 0x0000;PWM4T2 = PWM_Buf*PWM_Pre;PWM4CR= 0x80|PWMx->PWM_Channelx;break;
  52   2          case 5 : PWM5T1 = 0x0000;PWM5T2 = PWM_Buf*PWM_Pre;PWM5CR= 0x80|PWMx->PWM_Channelx;break;
  53   2          case 6 : PWM6T1 = 0x0000;PWM6T2 = PWM_Buf*PWM_Pre;PWM6CR= 0x80|PWMx->PWM_Channelx;break;
C51 COMPILER V9.59.0.0   PWM                                                               02/01/2021 21:09:41 PAGE 2   

  54   2          case 7 : PWM7T1 = 0x0000;PWM7T2 = PWM_Buf*PWM_Pre;PWM7CR= 0x80|PWMx->PWM_Channelx;break;
  55   2          default:break;
  56   2        }
  57   1        P_SW2 = 0x00;                               //Disallow Access to Extended RAM (STC Added)|禁止访问扩展RAM（STC新增）
  58   1        PWMCR = 0x80;                               //Start PWM module|启动PWM模块
  59   1      }
  60          


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    601    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =   ----    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----      12
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
